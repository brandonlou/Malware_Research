This is an implementation of
https://www.sciencedirect.com/science/article/abs/pii/S0952197616302512.

## Usage:

0. Install dependencies: `python`>=3.6, `numpy`, `sklearn`

### Model Training

1. Run `python preprocess.py <input dir> <output dir> <0/1>` to extract the the name, arguments, and
return value all API calls in the input directory and save
them in the output directory. `0` indicates that the reports are benign and `1` indicates that the
reports are malign.<br><br>
Example:<br>
`python preprocess.py /home/h3yin/syscall_research/reddit_data/mal_reports ~/preprocessed 1`<br>
`python preprocess.py /home/h3yin/syscall_research/reddit_data/ben_reports ~/preprocessed 0`

2. Run `python feature_gen.py <preprocessed dir> <output data file> [output features file]` to convert all the features into a binary
vector.<br><br>
Example: `python feature_gen.py ~/preprocessed data.csv`. If you also want to output the features, run `python feature_gen.py ~/preprocessed data.pkl features.pkl`.

3. Run `python fisher_score.py <input data file> <output data file> [output indices file]` to select important features using fisher
scoring.<br><br>
Example: `python fisher_score.py data.pkl data.pkl`. If you also want to output the indices of the selected features, run `python fisher_score.py data.pkl data.pkl indices.pkl`.

4. Run `python train_model.py <input data file> [output model file]` to train the model.<br><br>
Example: `python train_model.py data.pkl`. If you also want to output the model, run `python train_model.py data.pkl model.pkl`.

### Prediction

1. Preprocess the data (same as step 1 in "Model Training").<br><br>
Example: `python predict.py ~/mimicry_reports ~/pp_mimicry_reports`

2. Run `python predict.py <preprocessed dir> <feature file> <indices file> <model file>` to predict and output relevant metrics.<br><br>
Example: `python predict.py ~/pp_mimicry_reports features.pkl indices.pkl model.pkl`
