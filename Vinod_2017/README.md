This is an implementation of [https://link.springer.com/article/10.1007%2Fs13369-017-2828-0](https://link.springer.com/article/10.1007%2Fs13369-017-2828-0)

## Usage

0. Install dependencies: `numpy`, `sklearn`

### Model training

1. Run `python preprocessing.py <reports directory> <output directory> <0/1>`. The reports directory
must contain Cuckoo report JSON files. The output directory will be populated with corresponding
files from each report containing a list of that report's API calls. `0` indicates that all the
reports are benign and `1` means all the reports are malicious.<br><br>
Example:<br>
`python preprocessing.py /home/h3yin/syscall_research/reddit_data/mal_reports ~/preprocessed_reports 1`<br>
`python preprocessing.py /home/h3yin/syscall_research/reddit_data/ben_reports ~/preprocessed_reports 0`

2. Run `python feature_selection.py <preprocessed directory> <output file>`. The preprocessed
directory must contain all the preprocessed reports generated from the previous step. <br><br>
Example: `python feature_selection.py ~/preprocessed_reports ~/data.csv`

3. Run `python train_model.py <data input file> [model export file]`. This trains a model using the
data in the data file and optionally exports the model to a pickled file.<br><br>
Example: `python train_model.py ~/data.csv`

### Prediction

1. Run step 1 in "Model Training" to generate preprocessed reports.<br><br>
Example: `python preprocessing.py ~/mimicry_reports ~/pp_mimicry_reports 1`

2. Run `python predict.py <preprocessed reports> <features file> <model file>`.<br><br>
Example: `python predict.py ~/pp_mimicry_reports tf_idf.pkl model.pkl`
