import csv
import sys
from numpy import mean, std
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score, RepeatedStratifiedKFold


NUM_FOLDS = 10


def main():
    if len(sys.argv != 2):
        print('USAGE: python %s [data file]' % sys.argv[0])
    
    X_data = list()
    y_data = list()

    with open(sys.argv[1], 'rt') as csv_file:
        csv_reader = csv.reader(csv_file, delimeter=',')
        for row in csv_reader:
            X_data.append(row[:-1]) # All but the last element.
            y_data.append(row[-1])  # The last element.
    
    classifier = RandomForestClassifier()
    cv = RepeatedStratifiedKFold(n_splits=NUM_FOLDS, random_state=1)

    scores = cross_val_score(classifier, X_data, y_data, scoring='accuracy', cv=cv, n_jobs=-1, error_score='raise')
    print('Mean Accuracy: %.3f' % mean(scores))
    print('Standard Deviation: %.3f' % std(scores))


if __name__ == "__main__":
    main()