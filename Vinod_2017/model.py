import csv
import sys
from numpy import mean, std
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score, KFold, train_test_split
from sklearn.metrics import accuracy_score

NUM_FOLDS = 10


def main():
    if len(sys.argv) != 2:
        print('USAGE: python %s [data file]' % sys.argv[0])
    
    X_data = list()
    y_data = list()

    with open(sys.argv[1], 'rt') as csv_file:
        csv_reader = csv.reader(csv_file, delimiter=',')
        for row in csv_reader:
            X_data.append(list(map(float, row[:-1]))) # All but the last element.
            y_data.append(int(row[-1]))  # The last element.
    
    # Prepare cross-validation procedure.
    # cv = KFold(n_splits=10, random_state=1, shuffle=True)
    X_train, X_test, y_train, y_test = train_test_split(X_data, y_data, train_size=0.8, shuffle=True)    

    # Create model.
    rfc = RandomForestClassifier(n_estimators=100)
    rfc.fit(X_train, y_train)

    # Evaluate model.
    # scores = cross_val_score(classifier, X_data, y_data, scoring='accuracy', cv=cv, n_jobs=-1)
    y_pred = rfc.predict(X_test)
    print('Predicted:', y_pred)
    print('Actual:', y_test)
    print(accuracy_score(y_test, y_pred))


    # Report performance.
    # print(scores)
    # print('Mean Accuracy: %.3f' % mean(scores))
    # print('Standard Deviation: %.3f' % std(scores))


if __name__ == "__main__":
    main()
