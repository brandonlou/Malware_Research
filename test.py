import os
import json

api_list = set()

# for directory_name in ('malign_reports', 'benign_reports'):
for filename in os.listdir('/Volumes/Data/Malware_samples/mal_reports/'):
    # print(filename)
    with open('/Volumes/Data/Malware_samples/mal_reports/' + filename, 'r') as cuckoo_report_file:
        try:
            data = json.load(cuckoo_report_file)
        except:
            continue

        behavior = data.get('behavior', None)
        if behavior is None:
            continue

        processes = behavior.get('processes', None)
        if processes is None:
            continue

        for p in processes:
            for call in p.get('calls'):
                if call.get('category') == 'ole':
                    api_list.add(call.get('api'))

print(api_list)
